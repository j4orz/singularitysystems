<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Ch 1: au-197 - Singularity Systems: Zero to Hero</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Singularity Systems: Zero to Hero</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="chapter-1-au-197"><a class="header" href="#chapter-1-au-197">Chapter 1: au-197</a></h1>
<p><strong>This chapter introduces the golden age of systems ml</strong></p>
<h2 id="golden-age--software-20-infrastructure-buildout"><a class="header" href="#golden-age--software-20-infrastructure-buildout">Golden Age — Software 2.0 Infrastructure Buildout</a></h2>
<p>Welcome to the second golden age of computing. The first one took place in the
1940s when we discovered how to program sequences of instructions on
latency-oriented machines with scalar processing. We collectively refer to this
period as the <em>information revolution</em>. The second one is taking place today in
the 2020s where we are discovering how to compress sequences with stochastic
distributions on throughput-oriented machines with vector processing. People are
describing this period as the beginning of the <em>intelligence revolution</em>.</p>
<p>What we see in both periods is the occurence of positive-sum-game-generating
socioeconomic feedback loops dubbed "scaling laws" between software and hardware.
That is, the more demand generated from applications, the more supply from
infrastructure, which unlocks better applications, which generates more demand,
which increases the supply, and so on. The information revolution gave rise
to Moore's Law, an exponential trend between transistor density and TODO: X,
while the intelligence revolution today gives rise to Scaling Law's, another
exponential between compression and parameter count.</p>
<p>This textbook is all about the latter. More specifically we focus our attention
on the <strong>compilers and chips</strong> that are powering the massive AI infrastructure
buildout that's happening today. What's exciting from the perspective of a
compiler engineer or chip architect is that all of the assumptions held in the
design of our computers need to be reassessed and reevaluated. This is because
the "soul of the machine" is constructed by the dance that happens between the
compiler and chip — <em>together</em> through software-hardware codesign they bridge
the semantic gap between humans and electrons.</p>
<p>The original assumption held in the computers designed from the information
revolution was <a href="">Dennard Scaling</a> (also referred to as MOSFET Scaling) which
states that as the size of transistors decreases, the power density stays
constant.</p>
<p>TODO: von neumann prog/exec model.
The von neumann</p>
<p>What's interesting to systems programmers and performance engineers is that the
field is witnessing the rhyming of history. The feedback loop between the
information revolution's software applications and sequential hardware
(OOO, pipelining, TODO) creates this sociocultural phenomena dubbed
"Moore's Law"[X]. The same loop is happening with the intelligence revolution's
models and parallel hardware (tensor cores, TMA, TODO) which is now giving rise
to the "Scaling Laws"[X]. All of the original assumptions held in the design of
the compilers and chips that make up the soul of the machine are being reassessed
if the dominant workload is evaluating matrix multiplications for stochastic
distributions instead of fetching data for discrete algorithms.</p>
<p>In transportation technology is when humanity wants to go to the moon, engineers
reassess the design of vehicles from first principles. Given the workload of
space travel, it's economically feasiable to start from fundamentals and design
a rocket rather than a car or bus. As a result, the engineers behind the massive
infrastructure buildout are dubbing this period of
history as a new golden age:</p>
<ol>
<li>A New Golden Age for Computer Architecture[0] — Hennessy and Patterson</li>
<li>The Golden Age of Compiler Design[1] — Chris Lattner</li>
</ol>
<p>Many toy autograds exist — the software 2.0[2] version of calculator interpreters
capable of evaluating arithmetic. These are excellent in providing intuition for
backpropagation (calculus on a computational graph), a very important abstraction
to understand considering how leaky it is (think gradient initialization and
normalization). However, there are zero resources that dive deeper into cutting
your teeth on the advanced capabilities of PyTorch such as torch.compile and
torch distributed. Linux has xv6[3], clang has chibicc[4], and llvm has qbe[5],
but pytorch is missing it's teaching compiler. This is the gap that the course
fills.</p>
<p>The field of artificial intelligence is no stranger to pedagogical gaps.
Researchers talk about "research debt"[6] with respect to model development, but
what they forget to talk about is that the debt also applies to the underlying
infrastructure that powers the training and inference of deep neural networks.
This is largely in part because it's only been a decade since deep learning
has entered the zeitgeist of academia[7] and the public[8].</p>
<p>To give you a better idea of how nascent system ML as a field:</p>
<ol>
<li>the leading conferences for AI (NeurIPS) and Hardware (HOTCHIPS) have both
been running for ~30 years[9][10]. Meanwhile, the conference for the
intersection of the two (mlsys) has only been running for 6[11].</li>
<li>the lingua franca deep learning framework was released[12] less than a
decade, and the 2.0 release[13] was released only 2 years ago</li>
</ol>
<p>Welcome to the golden age of Systems ML!</p>
<h2 id="references"><a class="header" href="#references">References</a></h2>
<ol start="0">
<li><a href="https://proceedings.neurips.cc/paper_files/paper/2012/file/c399862d3b9d6b76c8436e924a68c45b-Paper.pdf">https://proceedings.neurips.cc/paper_files/paper/2012/file/c399862d3b9d6b76c8436e924a68c45b-Paper.pdf</a></li>
<li><a href="https://www.nature.com/articles/nature14539">https://www.nature.com/articles/nature14539</a></li>
<li><a href="https://www.youtube.com/watch?v=3LVeEjsn8Ts">https://www.youtube.com/watch?v=3LVeEjsn8Ts</a></li>
<li><a href="https://www.youtube.com/watch?v=4HgShra-KnY">https://www.youtube.com/watch?v=4HgShra-KnY</a></li>
<li><a href="https://karpathy.medium.com/software-2-0-a64152b37c35">https://karpathy.medium.com/software-2-0-a64152b37c35</a></li>
<li><a href="https://github.com/mit-pdos/xv6-public">https://github.com/mit-pdos/xv6-public</a></li>
<li><a href="https://github.com/rui314/chibicc">https://github.com/rui314/chibicc</a></li>
<li><a href="https://c9x.me/compile/">https://c9x.me/compile/</a></li>
<li><a href="https://distill.pub/2017/research-debt/">https://distill.pub/2017/research-debt/</a></li>
<li><a href="https://proceedings.neurips.cc/paper_files/paper/2012/file/c399862d3b9d6b76c8436e924a68c45b-Paper.pdf">https://proceedings.neurips.cc/paper_files/paper/2012/file/c399862d3b9d6b76c8436e924a68c45b-Paper.pdf</a></li>
<li><a href="https://www.nature.com/articles/nature14539">https://www.nature.com/articles/nature14539</a></li>
<li><a href="https://papers.nips.cc/">https://papers.nips.cc/</a></li>
<li><a href="https://hotchips.org/archives/">https://hotchips.org/archives/</a></li>
<li><a href="https://proceedings.mlsys.org/">https://proceedings.mlsys.org/</a></li>
<li><a href="https://soumith.ch/blog/2023-12-17-pytorch-design-origins.md.html">https://soumith.ch/blog/2023-12-17-pytorch-design-origins.md.html</a></li>
<li><a href="https://pytorch.org/assets/pytorch2-2.pdf">https://pytorch.org/assets/pytorch2-2.pdf</a></li>
</ol>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="dedication.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="ch2.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="dedication.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="ch2.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <!-- Livereload script (if served using the cli tool) -->
        <script>
            const wsProtocol = location.protocol === 'https:' ? 'wss:' : 'ws:';
            const wsAddress = wsProtocol + "//" + location.host + "/" + "__livereload";
            const socket = new WebSocket(wsAddress);
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload();
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
